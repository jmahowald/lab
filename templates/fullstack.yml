Name: fullstack
Modules:
- Name: network
  outputs:
  - vpc_id
  - vpc_cidr
  - public_subnet_ids
  - public_sg_id
  - availabity_zones
  uri: {{.Env.TF_VPC_LOCATION}}//modules/network
  module_vars:
  - module_name: amazon-amis
    mappings:
    - source_var_name: ami_id
      var_name: ami
    - var_name: image_user
  # The network module get's it's ami id from the ami module specified below'
  vars:
  - var_name: key_name
  - var_name: availability_zone_count
    default: 3
  - var_name: aws_region
    default: {{.Env.AWS_DEFAULT_REGION}}
  - var_name: environment
    default: {{.Env.ENV_NAME}}
  - var_name: owner
    default: {{.Env.OWNER}}
  - var_name: vpc_cidr
    default: {{.Env.VPC_CIDR_OCTET}}.0.0/16
  - var_name: public_subnet_cidrs
    type: list
    defaults:
    - {{.Env.VPC_CIDR_OCTET}}.0.0/24
    - {{.Env.VPC_CIDR_OCTET}}.1.0/24
    - {{.Env.VPC_CIDR_OCTET}}.2.0/24
  - var_name: private_subnet_cidrs
    type: list
    defaults:
    - {{.Env.VPC_CIDR_OCTET}}.10.0/24
    - {{.Env.VPC_CIDR_OCTET}}.11.0/24
    - {{.Env.VPC_CIDR_OCTET}}.12.0/24
- Name: amazon-amis
  local_path: {{.Env.TF_VPC_LOCATION}}//modules/amazon-amis
- module_name: sshkey
  uri: {{.Env.TF_VPC_LOCATION}}//modules/keys/keygen
  vars:
  - key_name
  - key_dir
- module_name: awske
  uri: {{.Env.TF_VPC_LOCATION}}//modules/keys/keygen
  vars:
  - key_name
  - key_dir

# - Name: ecs
#   uri: {{.Env.TF_ECS_LOCATION}}/cluster
#   outputs:
#   - elb_hostname 
#   module_vars:
#   - module_name: network
#     mappings:
#     - source_var_name: public_subnet_ids
#       var_name: elb_subnet_ids
#     - source_var_name: public_subnet_ids
#       var_name: asg_subnet_ids
#   vars:
#   - var_name: key_name
#   - var_name: asg_min
#     default: 1
#   - var_name: asg_max
#     default: 3
#   - var_name: asg_desired
#     default: 1
# - Name: amazon-amis
#   local_path: ../modules/amazon-amis